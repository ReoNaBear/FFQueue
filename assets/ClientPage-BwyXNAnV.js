import{c as Q,B as j,C as P,h,D as A,g as I,E as O,a as d,F as H,G as f,H as U,s as E,R as K,t as F,r as G,I as J,w as Y,u as y,v as s,x,J as l,K as b,z as r,L as D,M as L,N as W,O as n,P as o,Q as w,A as g,S as $,U as X,T as Z}from"./index-gjx5i3Ov.js";import{u as ee,a as te,_ as le,b as ie,Q as ae,d as se,c as V,e as ne}from"./_plugin-vue_export-helper-G98Wdf6I.js";import"./scroll-NNl9UgnC.js";const oe='<path d="M30.262 57.02L7.195 40.723c-5.84-3.976-7.56-12.06-3.842-18.063 3.715-6 11.467-7.65 17.306-3.68l4.52 3.76 2.6-5.274c3.716-6.002 11.47-7.65 17.304-3.68 5.84 3.97 7.56 12.054 3.842 18.062L34.49 56.118c-.897 1.512-2.793 1.915-4.228.9z" fill-opacity=".5"><animate attributeName="fill-opacity" begin="0s" dur="1.4s" values="0.5;1;0.5" calcMode="linear" repeatCount="indefinite"></animate></path><path d="M105.512 56.12l-14.44-24.272c-3.716-6.008-1.996-14.093 3.843-18.062 5.835-3.97 13.588-2.322 17.306 3.68l2.6 5.274 4.52-3.76c5.84-3.97 13.593-2.32 17.308 3.68 3.718 6.003 1.998 14.088-3.842 18.064L109.74 57.02c-1.434 1.014-3.33.61-4.228-.9z" fill-opacity=".5"><animate attributeName="fill-opacity" begin="0.7s" dur="1.4s" values="0.5;1;0.5" calcMode="linear" repeatCount="indefinite"></animate></path><path d="M67.408 57.834l-23.01-24.98c-5.864-6.15-5.864-16.108 0-22.248 5.86-6.14 15.37-6.14 21.234 0L70 16.168l4.368-5.562c5.863-6.14 15.375-6.14 21.235 0 5.863 6.14 5.863 16.098 0 22.247l-23.007 24.98c-1.43 1.556-3.757 1.556-5.188 0z"></path>',re=Q({name:"QSpinnerHearts",props:j,setup(e){const{cSize:a,classes:c}=P(e);return()=>h("svg",{class:c.value,fill:"currentColor",width:a.value,height:a.value,viewBox:"0 0 140 64",xmlns:"http://www.w3.org/2000/svg",innerHTML:oe})}}),de={xs:8,sm:10,md:14,lg:20,xl:24},T=Q({name:"QChip",props:{...ee,...A,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:a,emit:c}){const{proxy:{$q:v}}=I(),u=te(e,v),B=O(e,de),q=d(()=>e.selected===!0||e.icon!==void 0),_=d(()=>e.selected===!0?e.iconSelected||v.iconSet.chip.selected:e.icon),z=d(()=>e.iconRemove||v.iconSet.chip.remove),k=d(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),C=d(()=>{const i=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(i?` text-${i} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(k.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(u.value===!0?" q-chip--dark q-dark":"")}),S=d(()=>{const i=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},p={...i,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||v.lang.label.remove};return{chip:i,remove:p}});function M(i){i.keyCode===13&&N(i)}function N(i){e.disable||(c("update:selected",!e.selected),c("click",i))}function m(i){(i.keyCode===void 0||i.keyCode===13)&&(E(i),e.disable===!1&&(c("update:modelValue",!1),c("remove")))}function t(){const i=[];k.value===!0&&i.push(h("div",{class:"q-focus-helper"})),q.value===!0&&i.push(h(f,{class:"q-chip__icon q-chip__icon--left",name:_.value}));const p=e.label!==void 0?[h("div",{class:"ellipsis"},[e.label])]:void 0;return i.push(h("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},U(a.default,p))),e.iconRight&&i.push(h(f,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&i.push(h(f,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:z.value,...S.value.remove,onClick:m,onKeyup:m})),i}return()=>{if(e.modelValue===!1)return;const i={class:C.value,style:B.value};return k.value===!0&&Object.assign(i,S.value.chip,{onClick:N,onKeyup:M}),H("div",i,t(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[K,e.ripple]])}}}),ce=["top","middle","bottom"],R=Q({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>ce.includes(e)}},setup(e,{slots:a}){const c=d(()=>e.align!==void 0?{verticalAlign:e.align}:null),v=d(()=>{const u=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(u!==void 0?` text-${u}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>h("div",{class:v.value,style:c.value,role:"status","aria-label":e.label},F(a.default,e.label!==void 0?[e.label]:[]))}}),ue={key:0,class:"absolute-center text-center"},me={key:1,class:"column flex-center window-height q-pa-lg text-center"},be={class:"text-subtitle1 text-grey-7 q-mb-xl"},ve={class:"text-subtitle1 q-mt-sm"},ge={class:"text-primary text-weight-bolder"},xe={key:2,class:"column flex-center window-height q-pa-lg text-center"},ye={class:"text-subtitle1 text-grey-6 q-my-md"},he={class:"text-orange text-weight-bold"},fe={class:"text-primary text-weight-bold"},we={key:3,class:"column q-gutter-y-md"},qe={class:"cute-card relative-position overflow-hidden ticket-container animate-float"},_e={class:"q-pa-lg text-center relative-position"},ke={class:"my-number-text q-my-sm"},pe={class:"q-pa-md bg-orange-1 text-center"},Ce={class:"text-h3 text-weight-bolder text-dark"},Se={class:"q-mt-md"},Ne={class:"q-pb-xl",style:{"padding-bottom":"100px"}},Be={class:"row items-center q-mb-md"},ze={key:0,class:"banner-locked q-pa-md q-mb-md text-center text-grey-7 rounded-borders"},Me={class:"column q-gutter-y-sm"},$e={class:"col q-pl-sm"},Te={class:"text-subtitle1 text-weight-bold text-dark"},Qe={class:"row items-center q-gutter-x-sm"},De={class:"text-subtitle1 text-primary text-weight-bolder"},Le={key:1,class:"text-caption text-grey-6"},Ve={key:0,class:"row items-center bg-grey-1 rounded-borders q-pa-xs"},Re={class:"text-h6 q-mx-sm text-weight-bold",style:{"min-width":"24px","text-align":"center"}},je={key:1,class:"q-pa-md"},Pe={key:0,class:"fixed-bottom q-pa-md glass-footer z-top"},Ae={class:"row items-center justify-between"},Ie={class:"column"},Oe={class:"text-h5 text-weight-bolder text-primary"},He={class:"fullscreen bg-gradient-gold column flex-center text-center q-pa-md"},Ue={class:"text-h2 text-weight-bold q-my-lg"},Ee={class:"text-subtitle1 text-grey-8 q-mb-lg"},Ke={class:"text-primary text-weight-bold"},Fe={__name:"ClientPage",setup(e){const a=ie(),c=G(!1);J(()=>{a.init()});const v=d(()=>a.myNumber&&a.currentNumber>a.myNumber),u=d(()=>a.myNumber!=null&&a.currentNumber!=null?Math.max(0,a.myNumber-a.currentNumber):999),B=d(()=>u.value==0&&a.currentNumber==a.myNumber),q=m=>m.soldOut||m.qty<=0,_=d(()=>!v.value&&u.value<=5&&u.value>=0);function z(){navigator.vibrate&&navigator.vibrate(50),a.drawNewNumber()}function k(){a.clearMyState(),setTimeout(()=>{a.drawNewNumber()},300)}function C(m,t){navigator.vibrate&&navigator.vibrate(20),a.updateCart(m,t)}function S(){navigator.vibrate&&navigator.vibrate(50),a.submitSelection()}Y(B,m=>{m&&(c.value=!0)});const M=d(()=>{if(!a.startTime)return!0;const m=Date.now(),t=new Date(a.startTime).getTime();return m>=t}),N=d(()=>a.startTime?se.formatDate(a.startTime,"MM/DD HH:mm"):"");return(m,t)=>(s(),y(ae,{class:"q-pa-md pb-safe relative-position"},{default:x(()=>[t[23]||(t[23]=l("div",{class:"bg-decor"},null,-1)),(s(),b(D,null,L(12,i=>l("div",{key:i,class:"petal",style:W(`left: ${Math.random()*100}vw; width: ${10+Math.random()*15}px; height: ${10+Math.random()*15}px; animation-duration: ${8+Math.random()*10}s; animation-delay: -${Math.random()*10}s`)},null,4)),64)),n(a).isConnected?n(a).myNumber?v.value?(s(),b("div",xe,[r(f,{name:"sentiment_very_dissatisfied",size:"100px",color:"grey-5",class:"q-mb-md"}),t[11]||(t[11]=l("div",{class:"text-h4 text-grey-8 text-weight-bold"},"哎呀！您的號碼已過",-1)),l("div",ye,[t[7]||(t[7]=g(" 您的號碼是 ",-1)),l("span",he,o(n(a).myNumber),1),t[8]||(t[8]=l("br",null,null,-1)),t[9]||(t[9]=g(" 目前已經服務到 ",-1)),l("span",fe,o(n(a).currentNumber),1),t[10]||(t[10]=g(" 號 ",-1))]),r(w,{push:"",rounded:"",size:"lg",color:"secondary","text-color":"primary",class:"jelly-btn shadow-3",label:"重新抽取號碼牌",icon:"refresh",onClick:k})])):(s(),b("div",we,[t[18]||(t[18]=l("div",{class:"text-center q-mt-sm"},[l("div",{class:"text-h5 text-weight-bolder text-primary"},"✨ 排隊選購 ✨"),l("div",null,"ヽ(∀ﾟ )人(ﾟ∀ﾟ)人( ﾟ∀)人(∀ﾟ )人(ﾟ∀ﾟ)人( ﾟ∀)ﾉ")],-1)),l("div",qe,[t[15]||(t[15]=l("div",{class:"absolute-top full-width bg-gradient-gold",style:{height:"8px"}},null,-1)),l("div",_e,[t[12]||(t[12]=l("div",{class:"text-subtitle2 text-grey-6 text-weight-bold"},"YOUR NUMBER",-1)),l("div",ke,o(n(a).myNumber),1)]),t[16]||(t[16]=l("div",{class:"row justify-between items-center no-wrap q-px-sm"},[l("div",{class:"circle-cutout"}),l("div",{class:"dashed-line col"}),l("div",{class:"circle-cutout right"})],-1)),l("div",pe,[t[14]||(t[14]=l("div",{class:"text-subtitle1 text-grey-7"},"目前服務號碼 Current Call",-1)),l("div",Ce,"No."+o(n(a).currentNumber),1),l("div",Se,[u.value>5?(s(),y(T,{key:0,color:"grey-4","text-color":"grey-8",icon:"coffee"},{default:x(()=>[g(" 前方還有 "+o(u.value)+" 組顧客 ",1)]),_:1})):u.value>0?(s(),y(T,{key:1,color:"primary","text-color":"white",icon:"hourglass_top"},{default:x(()=>[g(" 即將輪到您！剩 "+o(u.value)+" 組 ",1)]),_:1})):(s(),y(T,{key:2,color:"negative","text-color":"white",icon:"stars"},{default:x(()=>[...t[13]||(t[13]=[g(" 輪到您了！請前往櫃檯 ",-1)])]),_:1}))])])]),l("div",Ne,[l("div",Be,[r(f,{name:"shopping_cart",color:"accent",size:"sm"}),t[17]||(t[17]=l("div",{class:"text-h6 q-ml-sm text-weight-bold text-dark"},"預選您想購買的商品 (可複選)",-1))]),_.value?$("",!0):(s(),b("div",ze,[r(f,{name:"lock"}),g(" 還有 "+o(u.value)+" 號以上，暫時無法進行預選 ",1)])),l("div",Me,[(s(!0),b(D,null,L(n(a).products,i=>(s(),b("div",{key:i.id,class:X(["cute-card q-pa-sm row items-center no-wrap",{"opacity-60":q(i)}])},[l("div",$e,[l("div",Te,o(i.name),1),l("div",Qe,[l("div",De," $"+o(i.price),1),q(i)?(s(),y(R,{key:0,color:"grey-8",label:"已售完",class:"text-weight-bold"})):(s(),b("div",Le,"庫存 "+o(i.qty),1)),i.limit>0?(s(),y(R,{key:2,outline:"",color:"pink-4",class:"bg-pink-1 text-weight-bold"},{default:x(()=>[g("限購 "+o(i.limit),1)]),_:2},1024)):$("",!0)])]),_.value&&!q(i)?(s(),b("div",Ve,[r(w,{round:"",dense:"",flat:"",icon:"remove",color:"grey-7",onClick:p=>C(i.id,-1),disable:!n(a).myCart[i.id]},null,8,["onClick","disable"]),l("div",Re,o(n(a).myCart[i.id]||0),1),r(w,{round:"",dense:"",flat:"",icon:"add",color:"primary",onClick:p=>C(i.id,1),disable:i.qty<=(n(a).myCart[i.id]||0)||i.limit>0&&(n(a).myCart[i.id]||0)>=i.limit},null,8,["onClick","disable"])])):(s(),b("div",je,[r(f,{name:"lock",color:"grey-4",size:"sm"})]))],2))),128))])])])):(s(),b("div",me,[t[6]||(t[6]=l("div",{class:"text-h4 text-weight-bolder text-primary q-mb-md"},"歡迎光臨排隊選購 ✨",-1)),l("div",be,"目前排隊人數 "+o(n(a).queueCount)+" 人",1),M.value?(s(),y(w,{key:0,push:"",rounded:"",size:"xl",color:"primary",class:"jelly-btn shadow-5",label:"抽取排隊號碼牌",icon:"confirmation_number",onClick:z})):(s(),y(V,{key:1,class:"cute-card q-pa-lg bg-grey-2 text-grey-8"},{default:x(()=>[r(f,{name:"schedule",size:"3rem",color:"grey-6",class:"q-mb-sm"}),t[5]||(t[5]=l("div",{class:"text-h6 text-weight-bold"},"活動尚未開始",-1)),l("div",ve,[t[3]||(t[3]=g(" 開放抽票時間：",-1)),t[4]||(t[4]=l("br",null,null,-1)),l("span",ge,o(N.value),1)])]),_:1}))])):(s(),b("div",ue,[r(re,{color:"primary",size:"4em"}),t[2]||(t[2]=l("div",{class:"text-primary q-mt-md"},"連線中...",-1))])),r(Z,{name:"slide-up"},{default:x(()=>[n(a).myNumber&&!v.value&&_.value?(s(),b("div",Pe,[l("div",Ae,[l("div",Ie,[t[19]||(t[19]=l("div",{class:"text-caption text-grey-7"},"預估總金額 Total",-1)),l("div",Oe,"$"+o(n(a).cartTotal),1)]),r(w,{push:"",rounded:"",color:"positive",class:"jelly-btn q-px-xl shadow-3",label:n(a).isSubmitted?"更新預選清單":"確認送出預選",icon:n(a).isSubmitted?"update":"check_circle",disable:n(a).cartCount===0,onClick:S},null,8,["label","icon","disable"])])])):$("",!0)]),_:1}),r(ne,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=i=>c.value=i),persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:x(()=>[l("div",He,[r(V,{class:"cute-card q-pa-xl shadow-24"},{default:x(()=>[t[22]||(t[22]=l("div",{class:"text-h4 text-weight-bolder text-primary"},"輪到您了！",-1)),l("div",Ue,"No."+o(n(a).myNumber),1),l("div",Ee,[t[20]||(t[20]=g(" 請帶著您的手機前往櫃檯結帳",-1)),t[21]||(t[21]=l("br",null,null,-1)),l("span",Ke,"預選金額: $"+o(n(a).cartTotal),1)]),r(w,{label:"我現在前往櫃檯",color:"primary",rounded:"",size:"lg",onClick:t[0]||(t[0]=i=>c.value=!1),class:"jelly-btn"})]),_:1})])]),_:1},8,["modelValue"])]),_:1}))}},We=le(Fe,[["__scopeId","data-v-a32c90f3"]]);export{We as default};
